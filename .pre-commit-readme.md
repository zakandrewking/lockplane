# Pre-commit Hooks for Lockplane

This project uses [pre-commit](https://pre-commit.com/) to automatically run quality checks before each commit.

## Quick Start

```bash
# Install pre-commit
pip install pre-commit

# Install the hooks
pre-commit install

# Done! Hooks will run automatically on git commit
```

## What Gets Checked

Every commit automatically runs:

1. **go fmt** - Formats all Go code
2. **go vet** - Catches common Go errors
3. **errcheck** - Ensures all error returns are checked
4. **staticcheck** - Advanced Go linting
5. **File checks** - Trailing whitespace, YAML syntax, etc.

## Manual Usage

Run all hooks manually:
```bash
pre-commit run --all-files
```

Run specific hook:
```bash
pre-commit run go-vet --all-files
```

## Skipping Hooks

**Not recommended**, but you can skip hooks with:
```bash
git commit --no-verify
```

## Installation Options

### Using pip
```bash
pip install pre-commit
```

### Using brew (macOS)
```bash
brew install pre-commit
```

### Using pipx
```bash
pipx install pre-commit
```

## Troubleshooting

### "command not found: errcheck"
The hook will automatically install errcheck on first run.

### "command not found: staticcheck"
The hook will automatically install staticcheck on first run.

### Slow commits?
The `go test` hook is disabled by default. If enabled, you can skip it:
```bash
SKIP=go-test git commit
```

## Why Pre-commit Hooks?

- ✅ Catches issues before CI runs (faster feedback)
- ✅ Prevents "fix lint" commits
- ✅ Consistent code quality across all contributors
- ✅ Reduces back-and-forth in code review
- ✅ Works automatically - no need to remember commands

## Configuration

See `.pre-commit-config.yaml` for the full configuration.

To update hooks to latest versions:
```bash
pre-commit autoupdate
```

## More Information

- [Pre-commit documentation](https://pre-commit.com/)
- [Available hooks](https://pre-commit.com/hooks.html)
